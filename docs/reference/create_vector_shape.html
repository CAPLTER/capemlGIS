<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Construct an ESRI shapefile and create metadata of type spatial
vector — create_vector_shape • capemlGIS</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Construct an ESRI shapefile and create metadata of type spatial
vector — create_vector_shape"><meta property="og:description" content="create_vector_shape generates a EML entity of type
spatialVector. The function allows the user to build a shapefile and
accompanying metadata from a spatial object read into or created within the
R environment. The resulting shapefile is written to a directory that is
then zipped for inclusion in a data package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">capemlGIS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/create_spatialRaster.html">create_spatialRaster</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct an ESRI shapefile and create metadata of type spatial
vector</h1>
    
    <div class="hidden name"><code>create_vector_shape.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>create_vector_shape generates a EML entity of type
spatialVector. The function allows the user to build a shapefile and
accompanying metadata from a spatial object read into or created within the
R environment. The resulting shapefile is written to a directory that is
then zipped for inclusion in a data package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_vector_shape</span><span class="op">(</span></span>
<span>  <span class="va">vector_name</span>,</span>
<span>  <span class="va">description</span>,</span>
<span>  geoDescription <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">coord_sys</span>,</span>
<span>  layer_opts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  projectNaming <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  missing_value_code <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>vector_name</dt>
<dd><p>(character) The unquoted name of the spatial object in the R environment.</p></dd>


<dt>description</dt>
<dd><p>(character) Description of the vector resource.</p></dd>


<dt>geoDescription</dt>
<dd><p>(character) A textual description of the geographic coverage of the vector.
If not provided, the project-level geographic desciption in the config.yaml
will be used.</p></dd>


<dt>coord_sys</dt>
<dd><p>(character) The quoted EML-compliant name of the coordinate reference
system.</p></dd>


<dt>layer_opts</dt>
<dd><p>(character) Additional options for generating a shapefile that are passed to
the sf::st_write function</p></dd>


<dt>overwrite</dt>
<dd><p>(logical) A logical indicating whether to overwrite an existing directory
bearing the same name as the shapefile.</p></dd>


<dt>projectNaming</dt>
<dd><p>(logical) Logical indicating if the zipped directory should be renamed per
the style used within the capeml ecosystem (default) with the project id +
base file name + md5sum + file extension (zip in this case). The name of the
shapefile + file extension (zip in this case) will be used if this is set to
FALSE. Note that this applies only to the zipped directory, the files that
constitute the shapefile are not renamed.</p></dd>


<dt>missing_value_code</dt>
<dd><p>(character) Quoted character(s) of a flag, in addition to NA or NaN, used to
indicate missing values within the data.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of type EML spatialVector is returned. Additionally, all
files that make up a single shapefile are harvested into a new directory
that is zipped for inclusion in the data package.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Unlike the package_vector_shape function in the capemlGIS package,
create_vector_shape writes a new shapefile to file. This allows the user to
produce a shapefile and corresponding metadata by either loading a spatial
object into the R environment or creating a spatial object with the R
environment. The shapefile that is written to file is packaged within a new
directory that is zipped for inclusion in a data package. Because a new
spatial object is created, the data can be modified as needed. If present,
the function reads attribute and factor metadata from supporting yaml
file(s) generated from the capeml::write_attributes() and
capeml::write_factors() functions - create_vector_shape will look for files
in the working directory with a name of type "entity name"_attrs.yaml (or
"entity name"_attrs.csv if an older project) for attribute metadata, and
"entity name"_factors.yaml (or "entity name"_factors.csv if an older
project) for factor metadata. Note that this functionality is predicated on
the existence of a file containing metadata about the attributes, that that
file is in the working directory, and that the file matches the name of the
spatial data entity precisely.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>If project naming is TRUE then create_vector will look for a package
number (packageNum (deprecated) or identifier) in config.yaml; this
parameter is not passed to the function and it must exist.</p>
<p>The shapefile generated from create_vector_shape will have the same
coordinate reference system (CRS) as the input spatial object.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load spatial vector object; because create_vector_shape will generate a</span></span></span>
<span class="r-in"><span><span class="co"># new shapefile, we have complete flexibility over the shapefile name and</span></span></span>
<span class="r-in"><span><span class="co"># manipulating the data - here we are starting with an existing shapefile</span></span></span>
<span class="r-in"><span><span class="co"># named CORETT but will generate a shapefile with the name</span></span></span>
<span class="r-in"><span><span class="co"># ejido_titles_points_of_decree </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ejido_titles_points_of_decree</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  dsn   <span class="op">=</span> <span class="st">"data/Regularizacion/ejidal"</span>,</span></span>
<span class="r-in"><span>  layer <span class="op">=</span> <span class="st">"CORETT"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="va">OBJECTID_1</span>,</span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="va">FolderNumb</span>,</span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="va">Surface</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Id</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"\\r\\n"</span>, replacement <span class="op">=</span> <span class="st">""</span>, x <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"--"</span>, replacement <span class="op">=</span> <span class="cn">NA_character_</span>, x <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># write attributes (and factors if relevant)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">write_attributes</span><span class="op">(</span><span class="va">ejido_titles_points_of_decree</span>, overwrite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a description for the data entity</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ejido_titles_points_of_decree_desc</span> <span class="op">&lt;-</span> <span class="st">"polygons of land regularized by the</span></span></span>
<span class="r-in"><span><span class="st">National Agency, CORETT; polygons were georeferenced from 281 paper maps,</span></span></span>
<span class="r-in"><span><span class="st">consolidated into 87 unique regularization degrees of ejidos that became</span></span></span>
<span class="r-in"><span><span class="st">privitzed from 1987-2007; includes the area of each polygon, the date of</span></span></span>
<span class="r-in"><span><span class="st">regularization, the name of the ejido, the delegation, and the 'plane</span></span></span>
<span class="r-in"><span><span class="st">number' that could be used to find the original map file in the CORETT</span></span></span>
<span class="r-in"><span><span class="st">office; it only includes expropriation for the delegations Xochimilco,</span></span></span>
<span class="r-in"><span><span class="st">Magdalena Contreras, Iztapalapa, Tlahuac, Gustavo Madero, Cuajimalpa, Alvaro</span></span></span>
<span class="r-in"><span><span class="st">Obregon, Tlalpan, Coyoacan, and Milpa Alta"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ejido_titles_points_of_decree_SV</span> <span class="op">&lt;-</span> <span class="fu">create_vector_shape</span><span class="op">(</span></span></span>
<span class="r-in"><span>  vector_name <span class="op">=</span> <span class="va">ejido_titles_points_of_decree</span>,</span></span>
<span class="r-in"><span>  description <span class="op">=</span> <span class="va">ejido_titles_points_of_decree_desc</span>,</span></span>
<span class="r-in"><span>  coord_sys <span class="op">=</span> <span class="st">"WGS_1984_UTM_Zone_55N"</span>,</span></span>
<span class="r-in"><span>  layer_opts <span class="op">=</span> <span class="st">"SHPT=POLYGON"</span>,</span></span>
<span class="r-in"><span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  projectNaming <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The resulting spatialVector entity can be added to a EML dataset.</span></span></span>
<span class="r-in"><span><span class="co"># Note also in this example that we are passing additional layer options,</span></span></span>
<span class="r-in"><span><span class="co"># which ultimately feed to sf::st_write, necessary here to generate a</span></span></span>
<span class="r-in"><span><span class="co"># multi-polygon shapefile.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by S Earl.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

