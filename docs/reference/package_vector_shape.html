<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create metadata of type spatial vector and package shapefile into a
zipped directory — package_vector_shape • capemlGIS</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create metadata of type spatial vector and package shapefile into a
zipped directory — package_vector_shape"><meta property="og:description" content="package_vector_shape generates a EML entity of type
spatialVector, and harvests all relevant files that constitute a single
shapefile into a directory that is then zipped."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">capemlGIS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/create_spatialRaster.html">create_spatialRaster</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create metadata of type spatial vector and package shapefile into a
zipped directory</h1>
    
    <div class="hidden name"><code>package_vector_shape.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>package_vector_shape generates a EML entity of type
spatialVector, and harvests all relevant files that constitute a single
shapefile into a directory that is then zipped.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">package_vector_shape</span><span class="op">(</span>
  <span class="va">dsn</span>,
  <span class="va">layer</span>,
  <span class="va">description</span>,
  geoDescription <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">coord_sys</span>,
  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,
  projectNaming <span class="op">=</span> <span class="cn">TRUE</span>,
  missing_value_code <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dsn</dt>
<dd><p>(character) The quoted name of the directory where the shapefile is
located. The trailing slash of a directory should not be included.</p></dd>
<dt>layer</dt>
<dd><p>(character) The quoted name of the shapefile (without a file extension).</p></dd>
<dt>description</dt>
<dd><p>(character) Description of the vector resource.</p></dd>
<dt>geoDescription</dt>
<dd><p>(character) A textual description of the geographic coverage of the vector.
If not provided, the project-level geographic desciption in the config.yaml
will be used.</p></dd>
<dt>coord_sys</dt>
<dd><p>(character) The quoted EML-compliant name of the coordinate reference
system.</p></dd>
<dt>overwrite</dt>
<dd><p>(logical) A logical indicating whether to overwrite an existing directory
bearing the same name as the shapefile.</p></dd>
<dt>projectNaming</dt>
<dd><p>(logical) Logical indicating if the zipped directory should be renamed per
the style used within the capeml ecosystem (default) with the project id +
base file name + md5sum + file extension (zip in this case). The name of the
shapefile + file extension (zip in this case) will be used if this is set to
FALSE. Note that this applies only to the zipped directory, the files that
constitute the shapefile are not renamed.</p></dd>
<dt>missing_value_code</dt>
<dd><p>(character) Quoted character(s) of a flag, in addition to NA or NaN, used to
indicate missing values within the data.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of type EML spatialVector is returned. Additionally, all
files that make up a single shapefile are harvested into a new directory
that is zipped for inclusion in the data package.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Unlike some other capemlGIS functions for managing vector data,
package_vector_shape does not create a new spatial entity but rather
collects all of the files that consititue a single shapefile, aggregates
those files into a single directory, then zips that directory for inclusion
in the data package. Metadata are generated on both spatial aspects of the
data and physical aspects of the zipped directory. Because a new spatial
object is not created, metadata must be constructed on the data as they
exist. That is, some data operations can be performed, such as classifying a
numerical ID field as character so that it does not require a unit, but the
data from which the metadata are constructed should not be edited. If
present, the function reads attribute and factor metadata from supporting
yaml file(s) generated from the capeml::write_attributes() and
capeml::write_factors() functions - package_vector_shape will look for files
in the working directory with a name of type "entity name"_attrs.yaml (or
"entity name"_attrs.csv if an older project) for attribute metadata, and
"entity name"_factors.yaml (or "entity name"_factors.csv if an older
project) for factor metadata. Note that this functionality is predicated on
the existence of a file containing metadata about the attributes, that that
file is in the working directory, and that the file matches the name of the
spatial data entity precisely.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>package_vector_shape will look for a package number (packageNum) in
config.yaml; this parameter is not passed to the function and it must exist.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># read spatial data into R and manipulate as necessary (but minimally as a</span></span>
<span class="r-in"><span class="co"># new data object is not created so the metadata should reflect the unaltered</span></span>
<span class="r-in"><span class="co"># source data)</span></span>
<span class="r-in"><span class="va">CORETT</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span></span>
<span class="r-in">  dsn <span class="op">=</span> <span class="st">"data/"</span>,</span>
<span class="r-in">  layer <span class="op">=</span> <span class="st">"CORETT"</span></span>
<span class="r-in">  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span class="r-in"><span class="fu">mutate</span><span class="op">(</span></span>
<span class="r-in">  Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Id</span><span class="op">)</span>,</span>
<span class="r-in">  Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># write an attributes metadata template (and factors if relevant (not shown))</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">capeml</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/capeml/man/write_attributes.html" class="external-link">write_attributes</a></span><span class="op">(</span><span class="va">CORETT</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># generate a description for the data entity</span></span>
<span class="r-in"><span class="va">corett_desc</span> <span class="op">&lt;-</span> <span class="st">"polygons of land regularized by the National Agency, CORETT;</span>
<span class="r-in">polygons were georeferenced from 281 paper maps, consolidated into 87 unique</span>
<span class="r-in">regularization degrees of ejidos that became privitzed from 1987-2007;</span>
<span class="r-in">includes the area of each polygon, the date of regularization, the name of</span>
<span class="r-in">the ejido, the delegation, and the 'plane number' that could be used to find</span>
<span class="r-in">the original map file in the CORETT office; it only includes expropriation</span>
<span class="r-in">for the delegations Xochimilco, Magdalena Contreras, Iztapalapa, Tlahuac,</span>
<span class="r-in">Gustavo Madero, Cuajimalpa, Alvaro Obregon, Tlalpan, Coyoacan, and Milpa</span>
<span class="r-in">Alta"</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># generate the spatial vector object, which can now be incorporated into our</span></span>
<span class="r-in"><span class="co"># EML dataset metadata; here we are relying on the geographic description in</span></span>
<span class="r-in"><span class="co"># the project config.yaml but we could overwrite that by passing an argument</span></span>
<span class="r-in"><span class="co"># to the geoDescription parameter if appropriate.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">corett_SV</span> <span class="op">&lt;-</span> <span class="fu">package_vector_shape</span><span class="op">(</span></span>
<span class="r-in">  dsn           <span class="op">=</span> <span class="st">"~/Desktop/shapedir/data"</span>,</span>
<span class="r-in">  layer         <span class="op">=</span> <span class="st">"CORETT"</span>,</span>
<span class="r-in">  description   <span class="op">=</span> <span class="va">corett_desc</span>,</span>
<span class="r-in">  <span class="va">geoDescription</span>,</span>
<span class="r-in">  coord_sys     <span class="op">=</span> <span class="st">"WGS_1984_UTM_Zone_55N"</span>,</span>
<span class="r-in">  overwrite     <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  projectNaming <span class="op">=</span> <span class="cn">TRUE</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The resulting spatialVector entity can be added to a EML dataset</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by S Earl.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

