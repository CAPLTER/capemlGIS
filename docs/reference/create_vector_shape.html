<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Construct an ESRI shapefile and create metadata of type spatial vector — create_vector_shape • capemlGIS</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Construct an ESRI shapefile and create metadata of type spatial vector — create_vector_shape"><meta name="description" content="create_vector_shape generates a EML entity of type
spatialVector. The function allows the user to build a shapefile and
accompanying metadata from a spatial object read into or created within the
R environment. The resulting shapefile is written to a directory that is
then zipped for inclusion in a data package."><meta property="og:description" content="create_vector_shape generates a EML entity of type
spatialVector. The function allows the user to build a shapefile and
accompanying metadata from a spatial object read into or created within the
R environment. The resulting shapefile is written to a directory that is
then zipped for inclusion in a data package."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">capemlGIS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/create_raster.html">Generate a EML entity of type spatialRaster</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Construct an ESRI shapefile and create metadata of type spatial vector</h1>

      <div class="d-none name"><code>create_vector_shape.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>create_vector_shape generates a EML entity of type
spatialVector. The function allows the user to build a shapefile and
accompanying metadata from a spatial object read into or created within the
R environment. The resulting shapefile is written to a directory that is
then zipped for inclusion in a data package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_vector_shape</span><span class="op">(</span></span>
<span>  <span class="va">vector_name</span>,</span>
<span>  <span class="va">description</span>,</span>
<span>  geoDescription <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">coord_sys</span>,</span>
<span>  layer_opts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  projectNaming <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  missing_value_code <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vector-name">vector_name<a class="anchor" aria-label="anchor" href="#arg-vector-name"></a></dt>
<dd><p>(character) The unquoted name of the spatial object in the R environment.</p></dd>


<dt id="arg-description">description<a class="anchor" aria-label="anchor" href="#arg-description"></a></dt>
<dd><p>(character) Description of the vector resource.</p></dd>


<dt id="arg-geodescription">geoDescription<a class="anchor" aria-label="anchor" href="#arg-geodescription"></a></dt>
<dd><p>(character) A textual description of the geographic coverage of the vector.
If not provided, the project-level geographic desciption in the config.yaml
will be used.</p></dd>


<dt id="arg-coord-sys">coord_sys<a class="anchor" aria-label="anchor" href="#arg-coord-sys"></a></dt>
<dd><p>(character) The quoted EML-compliant name of the coordinate reference
system.</p></dd>


<dt id="arg-layer-opts">layer_opts<a class="anchor" aria-label="anchor" href="#arg-layer-opts"></a></dt>
<dd><p>(character) Additional options for generating a shapefile that are passed to
the sf::st_write function</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>(logical) A logical indicating whether to overwrite an existing directory
bearing the same name as the shapefile.</p></dd>


<dt id="arg-projectnaming">projectNaming<a class="anchor" aria-label="anchor" href="#arg-projectnaming"></a></dt>
<dd><p>(logical) Logical indicating if the zipped directory should be renamed per
the style used within the capeml ecosystem (default) with the project id +
base file name + md5sum + file extension (zip in this case). The name of the
shapefile + file extension (zip in this case) will be used if this is set to
FALSE. Note that this applies only to the zipped directory, the files that
constitute the shapefile are not renamed.</p></dd>


<dt id="arg-missing-value-code">missing_value_code<a class="anchor" aria-label="anchor" href="#arg-missing-value-code"></a></dt>
<dd><p>(character) Quoted character(s) of a flag, in addition to NA or NaN, used to
indicate missing values within the data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of type EML spatialVector is returned. Additionally, all
files that make up a single shapefile are harvested into a new directory
that is zipped for inclusion in the data package.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Unlike the package_vector_shape function in the capemlGIS package,
create_vector_shape writes a new shapefile to file. This allows the user to
produce a shapefile and corresponding metadata by either loading a spatial
object into the R environment or creating a spatial object with the R
environment. The shapefile that is written to file is packaged within a new
directory that is zipped for inclusion in a data package. Because a new
spatial object is created, the data can be modified as needed. If present,
the function reads attribute and factor metadata from supporting yaml
file(s) generated from the capeml::write_attributes() and
capeml::write_factors() functions - create_vector_shape will look for files
in the working directory with a name of type "entity name"_attrs.yaml (or
"entity name"_attrs.csv if an older project) for attribute metadata, and
"entity name"_factors.yaml (or "entity name"_factors.csv if an older
project) for factor metadata. Note that this functionality is predicated on
the existence of a file containing metadata about the attributes, that that
file is in the working directory, and that the file matches the name of the
spatial data entity precisely.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If project naming is TRUE then create_vector will look for a package
number (packageNum (deprecated) or identifier) in config.yaml; this
parameter is not passed to the function and it must exist.</p>
<p>The shapefile generated from create_vector_shape will have the same
coordinate reference system (CRS) as the input spatial object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load spatial vector object; because create_vector_shape will generate a</span></span></span>
<span class="r-in"><span><span class="co"># new shapefile, we have complete flexibility over the shapefile name and</span></span></span>
<span class="r-in"><span><span class="co"># manipulating the data - here we are starting with an existing shapefile</span></span></span>
<span class="r-in"><span><span class="co"># named CORETT but will generate a shapefile with the name</span></span></span>
<span class="r-in"><span><span class="co"># ejido_titles_points_of_decree </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ejido_titles_points_of_decree</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  dsn   <span class="op">=</span> <span class="st">"data/Regularizacion/ejidal"</span>,</span></span>
<span class="r-in"><span>  layer <span class="op">=</span> <span class="st">"CORETT"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="va">OBJECTID_1</span>,</span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="va">FolderNumb</span>,</span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="va">Surface</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Id</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"\\r\\n"</span>, replacement <span class="op">=</span> <span class="st">""</span>, x <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"--"</span>, replacement <span class="op">=</span> <span class="cn">NA_character_</span>, x <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># write attributes (and factors if relevant)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">write_attributes</span><span class="op">(</span><span class="va">ejido_titles_points_of_decree</span>, overwrite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a description for the data entity</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ejido_titles_points_of_decree_desc</span> <span class="op">&lt;-</span> <span class="st">"polygons of land regularized by the</span></span></span>
<span class="r-in"><span><span class="st">National Agency, CORETT; polygons were georeferenced from 281 paper maps,</span></span></span>
<span class="r-in"><span><span class="st">consolidated into 87 unique regularization degrees of ejidos that became</span></span></span>
<span class="r-in"><span><span class="st">privitzed from 1987-2007; includes the area of each polygon, the date of</span></span></span>
<span class="r-in"><span><span class="st">regularization, the name of the ejido, the delegation, and the 'plane</span></span></span>
<span class="r-in"><span><span class="st">number' that could be used to find the original map file in the CORETT</span></span></span>
<span class="r-in"><span><span class="st">office; it only includes expropriation for the delegations Xochimilco,</span></span></span>
<span class="r-in"><span><span class="st">Magdalena Contreras, Iztapalapa, Tlahuac, Gustavo Madero, Cuajimalpa, Alvaro</span></span></span>
<span class="r-in"><span><span class="st">Obregon, Tlalpan, Coyoacan, and Milpa Alta"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ejido_titles_points_of_decree_SV</span> <span class="op">&lt;-</span> <span class="fu">create_vector_shape</span><span class="op">(</span></span></span>
<span class="r-in"><span>  vector_name <span class="op">=</span> <span class="va">ejido_titles_points_of_decree</span>,</span></span>
<span class="r-in"><span>  description <span class="op">=</span> <span class="va">ejido_titles_points_of_decree_desc</span>,</span></span>
<span class="r-in"><span>  coord_sys <span class="op">=</span> <span class="st">"WGS_1984_UTM_Zone_55N"</span>,</span></span>
<span class="r-in"><span>  layer_opts <span class="op">=</span> <span class="st">"SHPT=POLYGON"</span>,</span></span>
<span class="r-in"><span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  projectNaming <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The resulting spatialVector entity can be added to a EML dataset.</span></span></span>
<span class="r-in"><span><span class="co"># Note also in this example that we are passing additional layer options,</span></span></span>
<span class="r-in"><span><span class="co"># which ultimately feed to sf::st_write, necessary here to generate a</span></span></span>
<span class="r-in"><span><span class="co"># multi-polygon shapefile.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by S Earl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

