<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create metadata of type spatial vector and package shapefile into a zipped directory — package_vector_shape • capemlGIS</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create metadata of type spatial vector and package shapefile into a zipped directory — package_vector_shape"><meta name="description" content="package_vector_shape generates a EML entity of type
spatialVector, and harvests all relevant files that constitute a single
shapefile into a directory that is then zipped."><meta property="og:description" content="package_vector_shape generates a EML entity of type
spatialVector, and harvests all relevant files that constitute a single
shapefile into a directory that is then zipped."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">capemlGIS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/create_raster.html">Generate a EML entity of type spatialRaster</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create metadata of type spatial vector and package shapefile into a zipped directory</h1>

      <div class="d-none name"><code>package_vector_shape.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>package_vector_shape generates a EML entity of type
spatialVector, and harvests all relevant files that constitute a single
shapefile into a directory that is then zipped.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">package_vector_shape</span><span class="op">(</span></span>
<span>  <span class="va">dsn</span>,</span>
<span>  <span class="va">layer</span>,</span>
<span>  <span class="va">description</span>,</span>
<span>  geoDescription <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">coord_sys</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  projectNaming <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  missing_value_code <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dsn">dsn<a class="anchor" aria-label="anchor" href="#arg-dsn"></a></dt>
<dd><p>(character) The quoted name of the directory where the shapefile is
located. The trailing slash of a directory should not be included.</p></dd>


<dt id="arg-layer">layer<a class="anchor" aria-label="anchor" href="#arg-layer"></a></dt>
<dd><p>(character) The quoted name of the shapefile (without a file extension).</p></dd>


<dt id="arg-description">description<a class="anchor" aria-label="anchor" href="#arg-description"></a></dt>
<dd><p>(character) Description of the vector resource.</p></dd>


<dt id="arg-geodescription">geoDescription<a class="anchor" aria-label="anchor" href="#arg-geodescription"></a></dt>
<dd><p>(character) A textual description of the geographic coverage of the vector.
If not provided, the project-level geographic desciption in the config.yaml
will be used.</p></dd>


<dt id="arg-coord-sys">coord_sys<a class="anchor" aria-label="anchor" href="#arg-coord-sys"></a></dt>
<dd><p>(character) The quoted EML-compliant name of the coordinate reference
system.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>(logical) A logical indicating whether to overwrite an existing directory
bearing the same name as the shapefile.</p></dd>


<dt id="arg-projectnaming">projectNaming<a class="anchor" aria-label="anchor" href="#arg-projectnaming"></a></dt>
<dd><p>(logical) Logical indicating if the zipped directory should be renamed per
the style used within the capeml ecosystem (default) with the project id +
base file name + md5sum + file extension (zip in this case). The name of the
shapefile + file extension (zip in this case) will be used if this is set to
FALSE. Note that this applies only to the zipped directory, the files that
constitute the shapefile are not renamed.</p></dd>


<dt id="arg-missing-value-code">missing_value_code<a class="anchor" aria-label="anchor" href="#arg-missing-value-code"></a></dt>
<dd><p>(character) Quoted character(s) of a flag, in addition to NA or NaN, used to
indicate missing values within the data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of type EML spatialVector is returned. Additionally, all
files that make up a single shapefile are harvested into a new directory
that is zipped for inclusion in the data package.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Unlike some other capemlGIS functions for managing vector data,
package_vector_shape does not create a new spatial entity but rather
collects all of the files that consititue a single shapefile, aggregates
those files into a single directory, then zips that directory for inclusion
in the data package. Metadata are generated on both spatial aspects of the
data and physical aspects of the zipped directory. Because a new spatial
object is not created, metadata must be constructed on the data as they
exist. That is, some data operations can be performed, such as classifying a
numerical ID field as character so that it does not require a unit, but the
data from which the metadata are constructed should not be edited. If
present, the function reads attribute and factor metadata from supporting
yaml file(s) generated from the capeml::write_attributes() and
capeml::write_factors() functions - package_vector_shape will look for files
in the working directory with a name of type "entity name"_attrs.yaml (or
"entity name"_attrs.csv if an older project) for attribute metadata, and
"entity name"_factors.yaml (or "entity name"_factors.csv if an older
project) for factor metadata. Note that this functionality is predicated on
the existence of a file containing metadata about the attributes, that that
file is in the working directory, and that the file matches the name of the
spatial data entity precisely.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If project naming is TRUE then create_vector will look for a package
number (packageNum (deprecated) or identifier) in config.yaml; this
parameter is not passed to the function and it must exist.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read spatial data into R and manipulate as necessary (but minimally as a</span></span></span>
<span class="r-in"><span><span class="co"># new data object is not created so the metadata should reflect the unaltered</span></span></span>
<span class="r-in"><span><span class="co"># source data)</span></span></span>
<span class="r-in"><span><span class="va">CORETT</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  dsn <span class="op">=</span> <span class="st">"data/"</span>,</span></span>
<span class="r-in"><span>  layer <span class="op">=</span> <span class="st">"CORETT"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span><span class="fu">mutate</span><span class="op">(</span></span></span>
<span class="r-in"><span>  Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Id</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># write an attributes metadata template (and factors if relevant (not shown))</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">capeml</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/capeml/man/write_attributes.html" class="external-link">write_attributes</a></span><span class="op">(</span><span class="va">CORETT</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate a description for the data entity</span></span></span>
<span class="r-in"><span><span class="va">corett_desc</span> <span class="op">&lt;-</span> <span class="st">"polygons of land regularized by the National Agency, CORETT;</span></span></span>
<span class="r-in"><span><span class="st">polygons were georeferenced from 281 paper maps, consolidated into 87 unique</span></span></span>
<span class="r-in"><span><span class="st">regularization degrees of ejidos that became privitzed from 1987-2007;</span></span></span>
<span class="r-in"><span><span class="st">includes the area of each polygon, the date of regularization, the name of</span></span></span>
<span class="r-in"><span><span class="st">the ejido, the delegation, and the 'plane number' that could be used to find</span></span></span>
<span class="r-in"><span><span class="st">the original map file in the CORETT office; it only includes expropriation</span></span></span>
<span class="r-in"><span><span class="st">for the delegations Xochimilco, Magdalena Contreras, Iztapalapa, Tlahuac,</span></span></span>
<span class="r-in"><span><span class="st">Gustavo Madero, Cuajimalpa, Alvaro Obregon, Tlalpan, Coyoacan, and Milpa</span></span></span>
<span class="r-in"><span><span class="st">Alta"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate the spatial vector object, which can now be incorporated into our</span></span></span>
<span class="r-in"><span><span class="co"># EML dataset metadata; here we are relying on the geographic description in</span></span></span>
<span class="r-in"><span><span class="co"># the project config.yaml but we could overwrite that by passing an argument</span></span></span>
<span class="r-in"><span><span class="co"># to the geoDescription parameter if appropriate.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">corett_SV</span> <span class="op">&lt;-</span> <span class="fu">package_vector_shape</span><span class="op">(</span></span></span>
<span class="r-in"><span>  dsn           <span class="op">=</span> <span class="st">"~/Desktop/shapedir/data"</span>,</span></span>
<span class="r-in"><span>  layer         <span class="op">=</span> <span class="st">"CORETT"</span>,</span></span>
<span class="r-in"><span>  description   <span class="op">=</span> <span class="va">corett_desc</span>,</span></span>
<span class="r-in"><span>  <span class="va">geoDescription</span>,</span></span>
<span class="r-in"><span>  coord_sys     <span class="op">=</span> <span class="st">"WGS_1984_UTM_Zone_55N"</span>,</span></span>
<span class="r-in"><span>  overwrite     <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  projectNaming <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The resulting spatialVector entity can be added to a EML dataset</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by S Earl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

